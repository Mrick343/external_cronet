{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "bb6e52b2_9fa5bcfe",
        "filename": "components/cronet/android/api/src/android/net/http/ConnectionMigrationOptions.java",
        "patchSetId": 2
      },
      "lineNbr": 195,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2023-02-16T15:26:10Z",
      "side": 1,
      "message": "Do I remember correctly that this option will cause the connection to continually have one ping packet outstanding,? That\u0027s very bad for battery life (the modem will never go to sleep) so perhaps we should mention here that this is only for short-lived requests where responsiveness is important?",
      "range": {
        "startLine": 195,
        "startChar": 17,
        "endLine": 195,
        "endChar": 18
      },
      "revId": "966769701473f0fe2fad9596bc63daf6d54b7275",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f60d725e_d01e5f28",
        "filename": "components/cronet/android/api/src/android/net/http/ConnectionMigrationOptions.java",
        "patchSetId": 2
      },
      "lineNbr": 195,
      "author": {
        "id": 1743321
      },
      "writtenOn": "2023-02-16T16:19:17Z",
      "side": 1,
      "message": "This happens for all connections that have outstanding requests (including hanging GETs)[1] independently of migration options. And yes, this is a bad thing for battery life.\n\n(I discussed this with ianswett@ in the past and we agreed that it would be interesting to try making the pinging mechanism adaptive. Though, we haven\u0027t allocated any time towards this.)\n\n[1] https://source.chromium.org/chromium/chromium/src/+/main:net/third_party/quiche/src/quiche/quic/core/http/quic_spdy_session.cc;l\u003d885-890;drc\u003df37b11fe3cfd8d5f8294ef27d5c6c723a4028d89",
      "parentUuid": "bb6e52b2_9fa5bcfe",
      "range": {
        "startLine": 195,
        "startChar": 17,
        "endLine": 195,
        "endChar": 18
      },
      "revId": "966769701473f0fe2fad9596bc63daf6d54b7275",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "08ba22f6_b6c76e2d",
        "filename": "components/cronet/android/api/src/android/net/http/ConnectionMigrationOptions.java",
        "patchSetId": 2
      },
      "lineNbr": 263,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2023-02-16T15:26:10Z",
      "side": 1,
      "message": "IIRC the stack had some timers to force return to the default network even if migration succeeded, and also had some data limits for non-default network usage. Do those still exist? If so it might be worth mentioning here that they do.\n\nActually I see setMaxTimeOnNonDefaultNetworkSeconds below, and that we\u0027re not planning to expose  presumably since nobody uses it. Maybe, though, we could set that to a reasonable value (30 seconds?) and mention that here?\n\nWas there a data usage limit too? Or do I misremember? I guess for the data limit we should probably use getMultipathPreference.\n\nAlso, spurious trailing space.",
      "range": {
        "startLine": 263,
        "startChar": 28,
        "endLine": 263,
        "endChar": 37
      },
      "revId": "966769701473f0fe2fad9596bc63daf6d54b7275",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5e8edb36_5d927000",
        "filename": "components/cronet/android/api/src/android/net/http/ConnectionMigrationOptions.java",
        "patchSetId": 2
      },
      "lineNbr": 263,
      "author": {
        "id": 1978840
      },
      "writtenOn": "2023-02-16T16:10:18Z",
      "side": 1,
      "message": "\u003e IIRC the stack had some timers to force return to the default network even if migration succeeded, and also had some data limits for non-default network usage. Do those still exist? If so it might be worth mentioning here that they do.\n\nThat\u0027s right, by default the maximum time to be spent on non-default networks is set to 128 seconds (https://source.chromium.org/chromium/chromium/src/+/main:net/quic/quic_context.h;drc\u003df37b11fe3cfd8d5f8294ef27d5c6c723a4028d89;l\u003d52). \n\n\u003e Was there a data usage limit too? Or do I misremember? I guess for the data limit we should probably use getMultipathPreference.\n\nI don\u0027t see anything related to the number of bytes transfered in the migration code: https://source.chromium.org/chromium/chromium/src/+/main:net/quic/quic_chromium_client_session.cc;l\u003d3308;drc\u003df37b11fe3cfd8d5f8294ef27d5c6c723a4028d89;bpv\u003d1;bpt\u003d1, or any toggles that would imply such a value exists.\n\n\u003e Also, spurious trailing space.\n\nFixed.",
      "parentUuid": "08ba22f6_b6c76e2d",
      "range": {
        "startLine": 263,
        "startChar": 28,
        "endLine": 263,
        "endChar": 37
      },
      "revId": "966769701473f0fe2fad9596bc63daf6d54b7275",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}